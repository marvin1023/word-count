!function(t,e){"function"==typeof define&&define.amd?define(["$"],e):"object"==typeof exports?module.exports=e():t.WordCount=e(window.Zepto||window.jQuery||$)}(this,function(t){t.fn.WordCount=function(n){var o=[];return t(this).each(function(){var i=new e,l=t.extend({trigger:t(this)},n);i.init(l),o.push(i)}),o};var e=function(){};return e.prototype={init:function(e){var n=this;this.args=e,this.textBox=t(e.trigger),this.settings=t.extend({},e),this.oldNumber=0,this.minHeight=e.minHeight,this.number=0,this.timer=null,this.overClass=e.overClass||"",this.changeCallback=e.changeCallback||null,this.max=0,this.overflowCallback=e.overflowCallback||null,this.passClallback=e.passClallback||null,this.isOverflowCut=e.isOverflowCut||!0,n.withButton=t(e.withButton),this.num=t(e.num),n.max=e.max||parseInt(n.textBox.attr("maxLength"))||0,n.textBox.bind("focus",function(){n.start()}).bind("blur",function(t){clearInterval(n.timer)}),this.bindEvent(),this.checkNum()},bindEvent:function(){var t=this;this.touch(this.withButton,function(){return t.getFullNumber(),t.max&&t.number>t.max?(t.twinkle().done(function(){t.twinkle()}),!1):!0})},twinkle:function(){var t=this,e=null;return setTimeout(function(){t.textBox.addClass("error-number"),setTimeout(function(){t.textBox.removeClass("error-number"),e&&e()},100)},100),{done:function(t){e=t}}},touch:function(e,n,o){function i(t){return o.call(this,t)}var l;"function"==typeof n&&(o=n),t(e).on("touchmove",n,function(t){l=!0}).on("touchend",n,function(t){if(t.preventDefault(),!l){var e=o.call(this,t,"touch");e===!1&&(t.preventDefault(),t.stopPropagation())}l=!1}),t(e).on("mousedown",n,i)},start:function(){var t=this;t.timer=setInterval(function(){t.checkNum()},20)},checkNum:function(){var t=this;t.getFullNumber(),t.number!==t.oldNumber&&t.changeCallback&&(t.max&&t.number>t.max?t.overflowCallback?(t.num.addClass(t.overClass),t.textBox.addClass(t.overClass).attr("data-overflow",!0),t.overflowCallback(t,t.number,t.textBox,t.max)):t.isOverflowCut&&(t.textBox.val(t.textBox.val().slice(0,t.max)),t.getFullNumber()):(t.num.removeClass(t.overClass),t.textBox.removeClass(t.overClass).attr("data-overflow",""),t.passClallback&&t.passClallback.call(t,t.number,t.textBox,t.max)),t.num.html(t.max-t.number),t.changeCallback.call(t,t.number)),t.oldNumber=t.number,t.settings.minHeight&&(t.textBox.height(t.minHeight),t.textBox.height(t.textBox[0].scrollHeight))},getNumber:function(){return this.number=this.args.isByte?this.textBox.val().replace(/[^\x00-\xff]/g,"**").length:this.textBox.val().length,this.number},getFullNumber:function(){return this.number=this.textBox.val().replace(/[^\x00-\xff]/g,"**").length,this.number}},e});